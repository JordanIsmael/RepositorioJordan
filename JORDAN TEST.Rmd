---
title: "Análisis_Datos_Jordan"
author: "Jordan_Ismael"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

#install.packages("readxl")
#install.packages("dplyr")
#install.packages("ggplot2")
#install.packages("knitr")

library(readxl)
library(dplyr)
library(ggplot2)
library(knitr)
```

```{r}
#Cargamos la base de datos "Desoves.xlsx"
Sargo <- read_excel("Desove.xlsx", sheet = 1)

```


# Variación de variables con histogramas

## Desoves por temporada

```{r, warning=FALSE, message=FALSE}
ggplot(Sargo, aes(x = No_of_eggs)) +
  geom_histogram(aes(fill=..count..), bins = 12)+
  scale_fill_gradient("Count", low = "red", high = "green")+
  labs(title="Número de huevos por desove",
     y = "Frecuencia",
     x = "Número de huevos\n(x 1'000'000)")
```

## Temperatura del agua por temporada

```{r, warning=FALSE, message=FALSE}
ggplot(Sargo, aes(x = Water_Temp)) +
  geom_histogram(aes(fill=..count..), bins = 12)+
  scale_fill_gradient("Count", low = "red", high = "green")+
  labs(title="Temperatura del agua",
     y = "Frecuencia",
     x = "Temperatura (°C)")
```


## Fotoperiodo natural por temporada

```{r, warning=FALSE, message=FALSE}
ggplot(Sargo, aes(x = Day_length)) +
  geom_histogram(aes(fill=..count..), bins = 12)+
  scale_fill_gradient("Count", low = "red", high = "green")+
  labs(title="Fotoperiodo natural",
     y = "Frecuencia",
     x = "Horas de luz")
```


# Análisis exploratorio de datos

```{r, warning=FALSE, message=FALSE}

#Resúmen de datos
summary(na.omit(Sargo))

# Datos iniciales
tablainicio <- head(na.omit(Sargo))
tablainicio %>% knitr::kable(caption = "Datos iniciales de la tabla de datos")

#Datos finales
tablafinal <- tail(na.omit(Sargo))
tablafinal %>% knitr::kable(caption = "Datos finales de la tabla de datos")

#Estructura de los datos
str(Sargo)

# Tabla de Cantidad de desoves por temporada
Tabla <- table(na.omit(Sargo$Temporada))
Tabla %>% knitr::kable(col.names= c('Temporada', 'Número de desoves'), align = "cc", caption = "Cantidad de desoves por temporada")
```
### Los datos clasificados según temporada, no están balanceados.


# Gráficos de Relación entre variables

## Desoves por temporada

### Boxplot
```{r}
ggplot(data = na.omit(Sargo), aes(x= Temporada, y = No_of_eggs, fill=Temporada))+
  geom_boxplot()+
  labs(title="Número de huevos en temporadas",
     y = "Número de huevos (1´000´000)",
     x = "Temporada")
```

### Densidad
```{r}
ggplot(data = na.omit(Sargo), aes(x=No_of_eggs))+
  geom_density(aes_string(colour="Temporada"))+
  labs(title="Densidad",
     y = "Densidad",
     x = "Número de huevos\n(x 1'000'000)")
```

### Densidad acumulada
```{r}
ggplot(data = na.omit(Sargo), aes(x=No_of_eggs, color=Temporada))+
  stat_ecdf(geom = "step")+
  labs(title="Distribución empírica acumulada",
     y = "Porcentaje (%)",
     x = "Número de huevos\n(x 1'000'000)")
```

## Temperatura por desove

### Boxplot
```{r}
ggplot(data = na.omit(Sargo), aes(x = Temporada, y = Water_Temp, fill = Temporada))+
  geom_boxplot()+
  labs(title="Temperatura del agua en temporada",
     x = "Tratamiento",
     y = "Temperatura del agua (°C)")
```

## Temperatura del agua vs huevos
```{r}
ggplot(data = na.omit(Sargo), aes(x=Water_Temp, y=No_of_eggs))+
  geom_point(aes_string(colour="Temporada"))+
  labs(title="Relación entre Número de huevos y temperatura",
       x = "Número de huevos (1'000'000)",
       y = "Temperatura del agua")
```

### Densidad acumulada
```{r}
ggplot(data = na.omit(Sargo), aes(x=Day_length, y=No_of_eggs))+
  geom_point(aes_string(colour="Temporada"))+
  labs(title="Relación entre Número de huevos y el fotoperiodo natural",
       x = "Número de huevos (1'000'000)",
       y = "Horas de luz")
```

# Identificación de datos atípicos

## Número de huevos
```{r}
ggplot(data = na.omit(Sargo), aes(x= Temporada, y = No_of_eggs, fill=Temporada))+
  geom_boxplot(outlier.colour = "red")+
  labs(title="Número de huevos en temporadas",
     y = "Número de huevos (1´000´000)",
     x = "Temporada")
```
### El número de huevos presenta datos atípicos en la temporada 1, 2, 3 y 4

## Temperatura
```{r}
ggplot(data = na.omit(Sargo), aes(x= Temporada, y = Water_Temp, fill=Temporada))+
  geom_boxplot(outlier.colour = "red")+
  labs(title="Temperatura del agua en temporadas",
     y = "Temperatura (°C)",
     x = "Temporada")
```
### La temperatura del agua presenta datos atípicos en la temporada 1, 3 y 4.

## Fotoperiodo natural
```{r}
ggplot(data = na.omit(Sargo), aes(x= Temporada, y = Day_length, fill=Temporada))+
  geom_boxplot(outlier.colour = "red")+
  labs(title="Fotoperiodo natural en temporadas",
     y = "Horas de luz (h)",
     x = "Temporada")
```
### El fotoperiodo natural presenta datos atípicos en la temporada 5.


# Resumen de datos y estadística descriptiva usando Tablas

```{r}
# Estadística estadistica descriptiva del número de huevos en la temporada 1.
tablaHuevos<- Sargo%>%
  filter(Temporada=="1")%>%
  summarize(mean(No_of_eggs),sd(No_of_eggs),max(No_of_eggs),min(No_of_eggs))
knitr::kable(tablaHuevos,caption = "Estadisticos Descriptivos - Cantidad de huevos (x 1'000'000")

```



# Tansformación de variables
```{r}
#Sargo$Year <- as.character(Sargo$Year)
#Sargo$month <- factor(Sargo$month, levels = c("Enero", "Febrero", "Marzo","Abril", "Mayo", "Junio", "Julio", "Agosto", "Setiembre", "Octubre", "Noviembre", "Diciembre"))
#str(na.omit(Sargo))
```


